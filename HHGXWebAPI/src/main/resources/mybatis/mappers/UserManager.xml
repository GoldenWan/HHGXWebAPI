<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hhgx.soft.mappers.UserManagerMapper">
	
	<select id="retrieveZtreeNodes" resultMap="retrieveZtreeNodesMap">
	SELECT
		u.UserID userID,
		ut.UserTypeName userbelong,
		ut.UserBelongTo usertype,
		ml.ModuleName moduleName,
		mlz.ModuleID ModuleID,
		mlz.ModuleName ModuleNamez,
		mlz.URL URL
	FROM
		users u
	INNER JOIN usertype ut ON u.UserTypeID = ut.UserTypeID
	INNER JOIN module_usertype mt ON ut.UserTypeID = mt.UserTypeID
	INNER JOIN modulelist ml ON mt.ModuleID = ml.ModuleID
	INNER JOIN modulelist mlz ON ml.ParentID = mlz.ModuleID
	WHERE
		account = #{username};
	</select>
	
	 <resultMap type="retrieveZtreeNodes" id="retrieveZtreeNodesMap">
        <!-- 订单表属性 -->
        <id column="userID" property="userID" />
        <result column="orderno" property="userbelong" />
        <result column="userbelong" property="usertype" />
        <result column="moduleName" property="moduleName" />
        <!-- 关联的用户信息 -->
        <!-- association用于关联查询：
        property指属性，javaType是要映射的对象的类型。 -->
        <association property="childModule" javaType="childModule">
            <result column="ModuleID" property="moduleID" />
            <result column="ModuleNamez" property="moduleName" />
            <result column="URL" property="uRL" />
        </association>
    </resultMap>
	
</mapper>